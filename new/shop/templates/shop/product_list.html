{% extends 'base.html' %}

{% block title %}–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ - –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ products.number }}{% endblock %}

{% block content %}
<h2>–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h2>

<!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ -->
<form method="get" action="{% url 'product_list' %}" style="margin-bottom: 20px;">
    <input type="text" name="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..." value="{{ request.GET.search }}">
    <button type="submit">üîç –ù–∞–π—Ç–∏</button>
</form>

<!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ -->
<p>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ products.number }} –∏–∑ {{ products.paginator.num_pages }}</p>
<p>–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: {{ products.paginator.count }}</p>

<div class="products">
    {% for product in products %}
<div class="product-card">
    <h3>{{ product.POLN }}</h3>
    
    {% if product.ISKIZ %}
        <img src="{{ product.ISKIZ.url }}" alt="{{ product.ID }}" 
             style="max-width: 100%; height: 200px; object-fit: cover; border-radius: 5px;">
    {% else %}
        <div style="width: 100%; height: 200px; background: #f0f0f0; display: flex; align-items: center; justify-content: center; border-radius: 5px;">
            <span>–ù–µ—Ç —Ñ–æ—Ç–æ</span>
        </div>
    {% endif %}
    
    <p class="price">–¶–µ–Ω–∞: {{ product.SREDN }} —Ä—É–±.</p>
    <p>–ê—Ä—Ç–∏–∫—É–ª: {{ product.SLITN }}</p>
    <a href="{% url 'product_detail' product.ID %}">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
</div>
{% endfor %}
</div>

<!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
<div class="pagination" style="margin-top: 30px; text-align: center;">
    <span class="step-links">
        {% if products.has_previous %}
            <a href="?page=1{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" style="margin: 0 5px; padding: 5px 10px; border: 1px solid #ddd; text-decoration: none;">¬´ –ü–µ—Ä–≤–∞—è</a>
            <a href="?page={{ products.previous_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" style="margin: 0 5px; padding: 5px 10px; border: 1px solid #ddd; text-decoration: none;">‚Äπ –ù–∞–∑–∞–¥</a>
        {% endif %}

        <span class="current" style="margin: 0 10px;">
            –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ products.number }} –∏–∑ {{ products.paginator.num_pages }}
        </span>

        {% if products.has_next %}
            <a href="?page={{ products.next_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" style="margin: 0 5px; padding: 5px 10px; border: 1px solid #ddd; text-decoration: none;">–í–ø–µ—Ä–µ–¥ ‚Ä∫</a>
            <a href="?page={{ products.paginator.num_pages }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" style="margin: 0 5px; padding: 5px 10px; border: 1px solid #ddd; text-decoration: none;">–ü–æ—Å–ª–µ–¥–Ω—è—è ¬ª</a>
        {% endif %}
    </span>
</div>

<!-- –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º -->
<div style="text-align: center; margin-top: 15px;">
    {% for num in products.paginator.page_range %}
        {% if products.number == num %}
            <span style="margin: 0 5px; padding: 5px 10px; background: #3498db; color: white; border-radius: 3px;">{{ num }}</span>
        {% else %}
            <a href="?page={{ num }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" style="margin: 0 5px; padding: 5px 10px; border: 1px solid #ddd; text-decoration: none; border-radius: 3px;">{{ num }}</a>
        {% endif %}
    {% endfor %}
</div>

{% endblock %}
